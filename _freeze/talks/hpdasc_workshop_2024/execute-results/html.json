{
  "hash": "196934e04949e5120f540b79cf5c0a7f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Advances in climate features engineering and subsets modeling\"\nsubtitle: \"for Dengue forecasting\"\nauthor: \"Raphael Saldanha\"\ninstitute: \"HPDaSc Workshop on Data Driven Science - Inria\"\ndate: \"2024-05-31\"\ndescription: \"Talk at the HPDaSc Workshop on Data Driven Science.\"\ncategories: [brclim]\nimage: images/prec_map_1.png\nformat:\n  revealjs: \n    theme: inria_style.scss\n    logo: inria_logo.png\n    transition: fade\n    background-transition: fade\n    pointer:\n      pointerSize: 40\n      color: '#e63312'\ncode-link: true\nrevealjs-plugins:\n  - pointer\n---\n\n\n\n## Context of Climate-Sensitive diseases\n\n-   **Direct** relationship: floods, droughts, heat waves...\n\n-   **Indirect** relationship\n\n\n\n```{mermaid}\n%%{\n  init: {\n    'theme': 'base',\n    'themeVariables': {\n      'fontSize': '30px'\n    }\n  }\n}%%\nflowchart LR\n\nclimate(Climate) --> vector(Disease vectors) --> health(Human health)\nclimate --> health\nclimate --> social(Social & economic \\n determinants) --> health\n```\n\n\n\n## A time-lagged relationship\n\n::: columns\n::: {.column width=\"45%\"}\n-   Vector life cycle from a time perspective\n-   Climate conditions from the **past** leads to the disease incidence of **tomorrow**\n:::\n\n::: {.column width=\"55%\"}\n![](images/aedes_cycle.png){fig-align=\"center\"}\n:::\n:::\n\n## ERA5-Land reanalysis\n\n::: columns\n::: {.column width=\"40%\"}\n-   Copernicus, ECMWF\n-   Global coverage\n-   Hourly data\n-   1950 to the present (one week delay)\n-   Spatial resolution \\~9km\n-   Several climate indicators\n:::\n\n::: {.column width=\"60%\"}\n![](images/NL161-Sabater-Fig1.jpg){fig-align=\"center\"}\n:::\n:::\n\n## Challenge on data structures\n\n-   Climate indicators: grid data\n-   Disease incidence: tabular, individual cases aggregated by spatial regions and time spans\n\n::: columns\n::: {.column width=\"50%\"}\n![](images/temp.png){width=\"80%\"}\n:::\n\n::: {.column width=\"50%\"}\n![](images/admin.png){width=\"80%\"}\n:::\n:::\n\n## Zonal statistics\n\n![](images/zonal_statistics.png)\n\n## Resulting products {.small}\n\n::: columns\n::: {.column width=\"50%\"}\n-   ERA5-Land daily datasets\n    -   7,105 files, 658.7 GB\n    -   24,242 downloads on Zenodo\n\n-   Daily zonal statistics of climate indicators\n    -   8 selected indicators, 5,570 municipalities\n    -   6,085,749,761 records covering 1950-2023\n:::\n\n::: {.column width=\"50%\"}\n![](images/era5-land-daily-aggregates.png){fig-align=\"center\"}\n:::\n:::\n\n\n## Precipitation {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n![](images/prec_map_2.png){fig-align=\"center\" width=\"100%\"}\n:::\n\n::: {.column width=\"50%\"}\n![](images/prec_map_1.png){fig-align=\"center\" width=\"100%\"}\n:::\n:::\n\nRio de Janeiro municipalities. January 1, 2010.\n\n## Angra dos Reis\n\n![](images/angra.webp){fig-align=\"center\" width=\"100%\"}\n\n## Published paper {.small}\n\n::: columns\n::: {.column width=\"50%\"}\n-   Environmental Data Science journal\n-   Published on February 8, 2024\n-   Journal's most read paper of the month\n-   More than 9,000 datasets downloads on Zenodo so far\n:::\n\n::: {.column width=\"50%\"}\n[![](https://zenodo.org/badge/DOI/10.1017/eds.2024.3.svg)](https://doi.org/10.1017/eds.2024.3) ![](images/eds_paper.png)\n:::\n:::\n\n## brclimr R package {.small}\n\n::: columns\n::: {.column width=\"50%\"}\n-   [Package](https://rfsaldanha.github.io/brclimr/) to retrieve climate data of Brazilian municipalities\n-   Query remote parquet files stored on a S3 system\n-   Avoid huge dataset downloads when user wants only a subset of the data\n-   Available on [CRAN](https://cran.r-project.org/web/packages/brclimr/index.html). More than 3,000 downloads\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbrclimr::fetch_data(\n    code_muni = 3304557,\n    product = \"brdwgd\",\n    indicator = \"rh\",\n    statistics = \"mean\",\n    date_start = as.Date(\"2010-10-15\"),\n    date_end = as.Date(\"2010-10-20\")\n  )\n```\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n![](images/brclimr_downloads.gif){fig-align=\"center\" width=\"100%\"}\n:::\n:::\n\n## Usage {.small}\n\n::: columns\n::: {.column width=\"60%\"}\n-   Training multivariate **machine learning models** to forecast dengue incidence in Brazil with a **subsets strategy**\n\n$$\n{\\small\n\\begin{aligned}        D_t = \\mu + & \\theta_1 D_{t-1} + \\cdots + \\theta_p D_{t-p} + \\\\        & \\lambda_1 C_{t-1} + \\cdots + \\lambda_p C_{t-p} + \\\\         & \\varepsilon_1 e_{t-1} + \\cdots + \\varepsilon_p e_{t-p}    \\end{aligned}}\n$$\n\n-   Cluster municipalities based on dengue spread and climate regimes\n-   Train different models for each partition\n:::\n\n::: {.column width=\"40%\"}\n-   Accepted paper on **ICDE2024**, Multivariate Time Series Analytics workshop ![](images/icde.png){fig-align=\"center\" width=\"50%\"}\n:::\n:::\n\n## Next steps... {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n-   Continuous update\n-   Human settlements, population-weighted zonal statistics\n-   Compute climate time-series features: heat waves, persistent rains, etc.\n-   Adopt climate products with finer resolutions when possible (CHIRPS)\n-   Expand results to other countries\n:::\n\n::: {.column width=\"50%\"}\n![](images/pop_era5_grid_overlay.png){fig-align=\"center\" width=\"100%\"}\n:::\n:::\n\n##  {.big_text .center data-menu-title=\"Thanks\"}\n\n::: big_text\nThanks\n:::\n\n## Backup slides\n\n## Climate reanalysis\n\n<video controls loop preload data-autoplay src=\"https://climate.copernicus.eu/sites/default/files/2020-01/2019.11.21_ECMWF%20Reanalysis%20video_with%20caption_v4_IOB.mp4\">\n\n</video>\n\n## ERA5-Land hourly to daily aggregation\n\n-   Usage of [{KrigR}](https://github.com/ErikKusch/KrigR) package to access the [Copernicus Climate Data Store API](https://cds.climate.copernicus.eu), crop data at server side, download and perform the time aggregation.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndownload_ERA(Variable = \"2m_temperature\", DataSet = \"era5-land\", \n             DateStart = \"2022-12-01\", DateStop = \"2022-12-31\",\n             TResolution = \"day\", TStep = 1,\n             FUN = \"max\",\n             Extent = extent(c(-118.47,-34.1,-56.65, 33.28)), \n             Dir = \"dir_name\", FileName = \"file_name.nc\", \n             API_User = \"api_user\", API_Key = \"api_key\")\n```\n:::\n\n\n\n-   Took \\~15 days to download and process the data from 8 climate indicators covering the Latin America region\n\n## Computation\n\n-   Zonal statistics weighted by the fraction of the cell that is covered, with the [{exactextractr}](https://isciences.gitlab.io/exactextractr/) package\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexact_extract(\n  x = rst,\n  y = pol,\n  fun = \"mean\"\n)\n```\n:::\n\n\n\n## Results {.smaller}\n\n| ERA5-Land indicators  | Daily time-aggregating functions | Spatial zonal statistics    |\n|--------------------|----------------------------|------------------------|\n| Temperature (2m)      | mean, max, min                   | max, min, stdev, count      |\n| Dewpoint temp. (2m)   | mean                             | max, min, stdev, count      |\n| $u$ component of wind | mean                             | max, min, stdev, count      |\n| $v$ component of wind | mean                             | max, min, stdev, count      |\n| Surface pressure      | mean                             | max, min, stdev, count      |\n| Total precipitation   | sum                              | max, min, stdev, count, sum |\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}